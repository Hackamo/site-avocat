# GitHub Copilot Instructions for site-avocat

## Project Overview

- **Name**: Cabinet Martinet - Site Avocat
- **Type**: Angular 21+ standalone application with SSR
- **Purpose**: Law firm website specializing in immigration law
- **Deployment**: GitHub Pages (baseHref: `/site-avocat/`)

## Tech Stack

- **Framework**: Angular 21+ with standalone components (no NgModules)
- **Styling**: SCSS with Material Design 3 theme
- **State Management**: Angular Signals (no RxJS observables unless necessary)
- **Forms**: Reactive Forms with strict typing
- **HTTP**: Native fetch API (no HttpClient)
- **Animations**: Custom directives (AnimateText)
- **Build**: esbuild with SSR support

## Code Standards

### Components

- **Always use standalone components**: `standalone: true`
- **Change detection**: `changeDetection: ChangeDetectionStrategy.OnPush`
- **State**: Use `signal()` for all reactive state
- **Derived state**: Use `computed()` for derived values
- **Template bindings**: Use native control flow (`@if`, `@for`, `@switch`) - NOT `*ngIf`, `*ngFor`
- **Two-way binding**: Avoid; use reactive forms with input/output signals
- **Host bindings**: Use `host: { ... }` object in decorator, NOT `@HostBinding` decorator

### Inputs/Outputs

```typescript
// ✅ Correct - use input() and output() functions
import { input, output } from '@angular/core'

export class MyComponent {
  label = input<string>()
  onClick = output<string>()
}

// ❌ Avoid - old decorator syntax
@Input() label: string
@Output() onClick = new EventEmitter<string>()
```

### Services

- **Provide in root**: `@Injectable({ providedIn: 'root' })`
- **Injection**: Use `inject()` function, NOT constructor injection
- **No observables**: Use async/await with signals
- **Platform detection**: Always use `isPlatformBrowser()` for browser APIs

### Styling

- **Global styles**: `src/styles.scss`
- **Component styles**: Relative paths, e.g., `./my-component.scss`
- **CSS variables**: Use Material Design 3 tokens (e.g., `var(--mat-sys-primary)`)
- **Responsive**: Mobile-first with breakpoints at 600px, 768px, 960px
- **No ngClass/ngStyle**: Use class/style bindings directly

### Forms

```typescript
// ✅ Correct - Reactive forms with inject()
const fb = inject(FormBuilder)
const form = this.fb.group({
	email: ['', [Validators.required, Validators.email]],
	name: ['', Validators.required],
})

// Use form.valueChanges for reactive updates
```

## Project Structure

```
src/
├── app/
│   ├── directives/          #  AnimateText
│   ├── services/            # BlogDataService, ServicesDataService
│   ├── models/              # BlogArticle, etc.
│   ├── [pages]/             # home, blog, about, contact, prestations
│   ├── app.ts               # Root component
│   ├── app.routes.ts        # Routing config
│   └── app.config.ts        # DI configuration
├── assets/
│   └── blog/                # Markdown files (fetch at runtime)
└── styles.scss              # Global styles
```

## Key Patterns

### Animations

- **Text fade (slower)**: `<p animateText="fade">` (1200ms)
- **Variants**: `fade`, `slide-up`, `slide-left`, `slide-right`, `zoom`

### Image Loading

- **Skeleton loader**: Use `signal(false)` for `imageLoaded`, show skeleton if falsy
- **Fade-in**: Listen to `(load)` event, set signal true
- **No lazy loading library**: Use `priority` on hero images, native lazy load elsewhere

### Blog Articles

- **Format**: Markdown files in `src/assets/blog/`
- **Loading**: Fetch at runtime using native `fetch()`
- **Path**: Use relative paths for GitHub Pages: `assets/blog/file.md` (not `/assets/`)
- **Parsing**: Use `marked` library to convert markdown to HTML

### Voice Input (Contact Form)

- **API**: Web Speech API (webkitSpeechRecognition)
- **Language**: French (`fr-FR`)
- **Cleanup**: Stop on route change (NavigationStart), component destroy (ngOnDestroy), button toggle
- **Check**: `isPlatformBrowser()` before using API

## Common Tasks

### Add a new page

1. Create folder in `src/app/pages/`
2. Component: `standalone: true`, `ChangeDetectionStrategy.OnPush`
3. Add route to `app.routes.ts`
4. Import AnimateText directive
5. Add signal state (if needed)

### Fetch data at init

```typescript
constructor() {
  if (isPlatformBrowser(this.platformId)) {
    this.loadData()
  }
}

async loadData() {
  const response = await fetch('relative/path/file')
  const data = await response.json()
  this.items.set(data)
}
```

### Update global styles

- Animations: `.animate-scroll`, `.animate-text` in `src/styles.scss`
- Colors: Material Design 3 tokens via `var(--mat-sys-*)`
- Responsive: Use `@media (max-width: 600px)`, `(max-width: 768px)`, `(max-width: 960px)`

## GitHub Pages Deployment

- **Command**: `ng deploy`
- **Base href**: `/site-avocat/`
- **Asset paths**: Use relative paths (e.g., `assets/blog/file.md`, NOT `/assets/`)
- **Build output**: `dist/site-avocat/browser/`

## Accessibility

- ✅ WCAG AA compliant
- ✅ Semantic HTML (headings, lists, nav)
- ✅ ARIA labels on interactive elements
- ✅ Keyboard navigation support
- ✅ Color contrast ratio ≥ 4.5:1

## Performance

- ✅ OnPush change detection strategy on all components
- ✅ Signals instead of observables
- ✅ Image optimization with NgOptimizedImage
- ✅ Lazy loading routes (if applicable)
- ✅ Tree-shaking via standalone components

## Common Anti-Patterns (Avoid)

- ❌ NgModules or `@NgModule()`
- ❌ `OnPush: false` or default change detection
- ❌ Observable subscriptions without unsubscribe
- ❌ `*ngIf`, `*ngFor` - use `@if`, `@for`
- ❌ HttpClient - use native `fetch()`
- ❌ Constructor injection - use `inject()`
- ❌ `@HostBinding`, `@HostListener` - use `host: { ... }`
- ❌ Absolute paths for assets on GitHub Pages
- ❌ ngClass/ngStyle - use `[class]` and `[style]`

## Questions to Ask Before Generating Code

1. Is this a new standalone component or service?
2. Does it need reactive state? (use `signal()`)
3. Does it need animations? (use AnimateText directive)
4. Is it fetching data? (use native `fetch()`)
5. Is it browser-only code? (wrap in `isPlatformBrowser()` check)
6. Does it need styling? (use SCSS with Material Design tokens)

---

**Last Updated**: January 26, 2026
