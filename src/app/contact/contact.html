<div class="container contact-page">
	@if (isSubmitting()) {
	<div class="submission-overlay" role="alert" aria-live="polite">
		<mat-spinner diameter="64"></mat-spinner>
		<p class="submission-overlay__text">{{ 'contact.submitting' | translate }}</p>
	</div>
	}
	<header class="page-header">
		<h1 class="mat-display-2">{{ 'contact.title' | translate }}</h1>
		<p class="mat-headline-5">{{ 'contact.subtitle' | translate }}</p>
	</header>

	<div class="contact-content">
		<!-- Informations de contact -->
		<section class="contact-info">
			<mat-card class="info-card" animateText="fade">
				<mat-card-header>
					<mat-icon mat-card-avatar>phone</mat-icon>
					<mat-card-title>{{ 'contact.phone.title' | translate }}</mat-card-title>
				</mat-card-header>
				<mat-card-content>
					<p>{{ 'contact.phone.number' | translate }}</p>

					<p class="subtitle">{{ 'contact.phone.hours' | translate }}</p>
					<a mat-flat-button href="tel:+33123456789">
						<mat-icon>phone</mat-icon>
						{{ 'contact.phone.button' | translate }}
					</a>
				</mat-card-content>
			</mat-card>

			<mat-card
				animateText="fade"
				class="info-card"
				(click)="copyToClipboard('contact@maitre-martinet.fr', 'contact.email.copied')"
			>
				<mat-card-header>
					<mat-icon mat-card-avatar>email</mat-icon>
					<mat-card-title>{{ 'contact.email.title' | translate }}</mat-card-title>
				</mat-card-header>
				<mat-card-content>
					<div class="copy-row" [attr.aria-label]="'contact.email.aria' | translate">
						<p class="copy-text">{{ 'contact.email.address' | translate }}</p>
						<button
							mat-icon-button
							class="copy-btn"
							[attr.aria-label]="'contact.email.copyLabel' | translate"
						>
							<mat-icon>content_copy</mat-icon>
						</button>
					</div>
					<p class="subtitle">{{ 'contact.email.response' | translate }}</p>
					<a
						mat-flat-button
						href="mailto:contact@maitre-martinet.fr?subject=Demande%20de%20consultation%20juridique&body=Bonjour%20Ma%C3%AEtre%20Martinet%2C%0A%0AJe%20vous%20contacte%20au%20sujet%20de%20%3A%0A%0ANom%20%3A%20%0APr%C3%A9nom%20%3A%20%0AT%C3%A9l%C3%A9phone%20%3A%20%0A%0AObjet%20de%20la%20demande%20%3A%0A%0A%0ACordialement%2C"
					>
						<mat-icon>email</mat-icon>
						{{ 'contact.email.button' | translate }}
					</a>
				</mat-card-content>
			</mat-card>

			<mat-card class="info-card" animateText="fade">
				<mat-card-header>
					<mat-icon mat-card-avatar>schedule</mat-icon>
					<mat-card-title>{{ 'contact.hours.title' | translate }}</mat-card-title>
				</mat-card-header>
				<mat-card-content>
					<ul class="hours-list" [attr.aria-label]="'contact.hours.aria' | translate">
						<li class="hours-item open" [attr.aria-label]="'contact.hours.weekdays.aria' | translate">
							<mat-icon aria-hidden="true">check_circle</mat-icon>
							<span class="day">{{ 'contact.hours.weekdays.label' | translate }}</span>
							<span class="time">{{ 'contact.hours.weekdays.time' | translate }}</span>
						</li>
						<li
							class="hours-item appointment"
							[attr.aria-label]="'contact.hours.saturday.aria' | translate"
						>
							<mat-icon aria-hidden="true">event_available</mat-icon>
							<span class="day">{{ 'contact.hours.saturday.label' | translate }}</span>
							<span class="note">{{ 'contact.hours.saturday.note' | translate }}</span>
						</li>
						<li class="hours-item closed" [attr.aria-label]="'contact.hours.sunday.aria' | translate">
							<mat-icon aria-hidden="true">cancel</mat-icon>
							<span class="day">{{ 'contact.hours.sunday.label' | translate }}</span>
							<span class="note">{{ 'contact.hours.sunday.note' | translate }}</span>
						</li>
					</ul>
				</mat-card-content>
			</mat-card>

			<mat-card
				animateText="fade"
				class="info-card"
				(click)="copyToClipboard('5 Avenue de la RÃ©publique, 33000 Bordeaux', 'contact.address.copied')"
			>
				<mat-card-header>
					<mat-icon mat-card-avatar>location_on</mat-icon>
					<mat-card-title>{{ 'contact.address.title' | translate }}</mat-card-title>
				</mat-card-header>
				<mat-card-content>
					<div class="copy-row" [attr.aria-label]="'contact.address.aria' | translate">
						<p class="copy-text">
							{{ 'contact.address.line1' | translate }}<br />{{ 'contact.address.line2' | translate }}
						</p>
						<button
							mat-icon-button
							class="copy-btn"
							[attr.aria-label]="'contact.address.copyLabel' | translate"
						>
							<mat-icon>content_copy</mat-icon>
						</button>
					</div>
					<div class="map-container">
						@if (iframeLoading()) {
						<div class="iframe-loader">
							<mat-spinner diameter="60"></mat-spinner>
							<p>{{ 'contact.address.mapLoading' | translate }}</p>
						</div>
						}
						<iframe
							src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2829.078425044478!2d-0.5997146!3d44.840336199999996!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd5527da20689615%3A0x1a5b7e0cc1d30f05!2sDefis%20avocats!5e0!3m2!1sfr!2sfr!4v1769534638232!5m2!1sfr!2sfr"
							width="100%"
							height="200"
							style="border: 0; border-radius: 8px; margin-top: 1rem"
							allowfullscreen="true"
							loading="lazy"
							referrerpolicy="no-referrer-when-downgrade"
							[attr.title]="'contact.address.mapTitle' | translate"
							(load)="onIframeLoad()"
							[style.display]="iframeLoading() ? 'none' : 'block'"
						></iframe>
					</div>
				</mat-card-content>
			</mat-card>
		</section>

		<!-- Formulaire de contact -->
		<section class="contact-form">
			<mat-card>
				<mat-card-header>
					<mat-card-title>{{ 'contact.form.title' | translate }}</mat-card-title>
					<mat-card-subtitle>{{ 'contact.form.subtitle' | translate }}</mat-card-subtitle>
				</mat-card-header>
				<mat-card-content>
					<form [formGroup]="contactForm" (ngSubmit)="onSubmit()" class="contact-form-fields">
						<mat-form-field animateText="fade" appearance="outline" class="full-width">
							<mat-label>{{ 'contact.form.name.label' | translate }}</mat-label>
							<input matInput formControlName="name" required />
							@if (contactForm.get('name')?.invalid && contactForm.get('name')?.touched) {
							<mat-error>{{ 'contact.form.name.error' | translate }}</mat-error>
							}
						</mat-form-field>

						<mat-form-field animateText="fade" appearance="outline" class="full-width">
							<mat-label>{{ 'contact.form.email.label' | translate }}</mat-label>
							<input matInput type="email" formControlName="email" required />
							@if (contactForm.get('email')?.invalid && contactForm.get('email')?.touched) {
							<mat-error>{{ 'contact.form.email.error' | translate }}</mat-error>
							}
						</mat-form-field>

						<mat-form-field animateText="fade" appearance="outline" class="full-width">
							<mat-label>{{ 'contact.form.phone.label' | translate }}</mat-label>
							<input matInput formControlName="phone" />
						</mat-form-field>

						<mat-form-field animateText="fade" appearance="outline" class="full-width">
							<mat-label>{{ 'contact.form.subject.label' | translate }}</mat-label>
							<mat-select formControlName="subject" required>
								<mat-option value="consultation"
									>{{ 'contact.form.subject.options.consultation' | translate }}</mat-option
								>
								<mat-option value="information"
									>{{ 'contact.form.subject.options.information' | translate }}</mat-option
								>
								<mat-option value="urgence"
									>{{ 'contact.form.subject.options.urgence' | translate }}</mat-option
								>
								<mat-option value="autre"
									>{{ 'contact.form.subject.options.autre' | translate }}</mat-option
								>
							</mat-select>
							@if (contactForm.get('subject')?.invalid && contactForm.get('subject')?.touched) {
							<mat-error>{{ 'contact.form.subject.error' | translate }}</mat-error>
							}
						</mat-form-field>

						<mat-form-field
							animateText="fade"
							floatLabel="always"
							appearance="outline"
							class="full-width message-field-wrapper"
						>
							<mat-label>{{ 'contact.form.message.label' | translate }}</mat-label>
							<textarea
								matInput
								formControlName="message"
								rows="7"
								maxlength="1000"
								required
								spellcheck="true"
								class="message-textarea"
								[attr.placeholder]="'contact.form.message.placeholder' | translate"
							></textarea>
							@if (speechSupported()) {
							<button
								mat-icon-button
								type="button"
								class="voice-input-button"
								[class.listening]="isListening()"
								(click)="startVoiceInput()"
								matSuffix
							>
								<mat-icon>{{ isListening() ? 'mic' : 'mic_none' }}</mat-icon>
							</button>
							} @if (contactForm.get('message')?.invalid && contactForm.get('message')?.touched) {
							<mat-error>{{ 'contact.form.message.error' | translate }}</mat-error>
							}
							<mat-hint
								>{{ contactForm.get('message')?.value?.length || 0 }}/1000 {{
								'contact.form.message.characters' | translate }}</mat-hint
							>
						</mat-form-field>
						<mat-hint>{{ 'contact.form.message.hint' | translate }}</mat-hint>

						<div class="form-actions">
							<button matFab extended type="submit" [disabled]="contactForm.invalid || isSubmitting()">
								<mat-icon>send</mat-icon>
								@if (!isSubmitting()) {
								<span>{{ 'contact.form.submit' | translate }}</span>
								} @else {
								<span>{{ 'contact.form.submitting' | translate }}</span>
								}
							</button>
						</div>
					</form>
				</mat-card-content>
			</mat-card>
		</section>
	</div>

	<!-- Section CTA -->
	<section class="cta-section text-center" animateText="fade">
		<h2 class="mat-headline-4">{{ 'contact.cta.title' | translate }}</h2>
		<p>{{ 'contact.cta.description' | translate }}</p>
		<a mat-flat-button href="tel:+33123456789">
			<mat-icon>phone</mat-icon>
			{{ 'contact.cta.button' | translate }}
		</a>
	</section>
</div>
